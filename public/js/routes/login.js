// Generated by CoffeeScript 1.3.3
(function() {

  define(["guru/server", "guru/notify", "templates/login"], function(server, notify, templ) {
    return function(args, templ) {
      $('#content').append(templ());
      $('#login-modal').modal();
      $('#login-modal #email').focus();
      $('#login-modal').on('hide', function() {
        return window.location.hash = '#/';
      });
      $('#login-form').submit(function() {
        var fields;
        fields = {
          email: $('#login-form #email').val(),
          password: $('#login-form #password').val()
        };
        server.login(fields, function(err, user) {
          if (err != null) {
            return notify.error("Error logging in: " + err);
          }
          $('#login-modal').modal('hide');
          return window.location.hash = '#/home';
        });
        return false;
      });
      return $('#login-cancel-button').click(function() {
        $('#login-modal').modal('hide');
        return window.location.hash = '#/';
      });
    };
  });

}).call(this);
