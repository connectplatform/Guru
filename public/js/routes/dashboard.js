// Generated by CoffeeScript 1.3.1
(function() {

  define(["guru/server", "guru/notify", "routes/sidebar", "templates/sidebar", "guru/util"], function(server, notify, sidebar, sbTemp, util) {
    return function(args, templ) {
      if (!server.cookie('login')) {
        window.location = '/';
      }
      return server.ready(function() {
        return server.getActiveChats(function(err, chats) {
          sidebar({}, sbTemp);
          $('#content').html(templ({
            chats: [
              {
                id: 'abc123',
                visitor: 'Bob',
                operator: 'Frank S',
                started: new Date(),
                website: 'google.com',
                department: 'catering'
              }, {
                id: 'bcf482',
                visitor: 'Chris',
                operator: 'Sally P',
                started: new Date(),
                website: 'reddit.com',
                department: 'clowns'
              }
            ]
          }));
          util.autotimer('.counter');
          return $(window).bind('hashchange', function() {
            return util.cleartimers();
          });
        });
      });
    };
  });

}).call(this);
