// Generated by CoffeeScript 1.3.3
(function() {

  define(["guru/server", "templates/newChat"], function(server, newChat) {
    return function(_arg, templ) {
      var id;
      id = _arg.id;
      $("#content").html(templ());
      return server.refresh(function(services) {
        console.log("services: " + services);
        $("#message-form").submit(function() {
          var message;
          message = $("#message").val();
          server[id](message, function(err, data) {
            if (err && (typeof console !== "undefined" && console !== null)) {
              return console.log(err);
            }
          });
          return false;
        });
        return server.subscribe[id](function(err, data) {
          return $("#displayBox").append("<p>" + data.username + ": " + data.message + "</p>");
        });
      });
    };
  });

}).call(this);
