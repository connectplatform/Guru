// Generated by CoffeeScript 1.3.1
(function() {

  define(["guru/server", "templates/newChat"], function(server, newChat) {
    return function(_, templ) {
      $("#content").html("Loading...");
      return server.refresh(function() {
        $("#content").html(templ());
        return $("#newChat-form").submit(function() {
          var username;
          username = $("#newChat-form #username").val();
          console.log("username:" + username);
          server.newChat({
            username: username
          }, function(err, data) {
            return window.location.hash = "/visitorChat/" + data.channel;
          });
          $("#newChat-form").hide();
          $("#content").html("Connecting to chat...");
          return false;
        });
      });
    };
  });

}).call(this);
